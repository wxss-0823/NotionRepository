# Ruby 教程

## 1. Ruby 基础教程

### 1.1. 中文编码

​	首行添加一行注释，告诉解释器使用 UTF-8 来解析源码，并设置编辑器保存文件的编码为 UTF-8。

```ruby
# -*- coding: UTF-8 -*-
```

### 1.2. 命令行选项

​	Ruby 一般是从命令行运行，运行方式如下：

```shell
ruby [ options ] [.] [ programfile ] [ arguments ... ]
```

​	解释器可以通过下列选项被调用，来控制解释器的环境和行为。

| 选项          | 描述                                                         |
| ------------- | ------------------------------------------------------------ |
| `-a`          | 与 `-n` 或 `-p` 一起使用，可以打开自动差分模式（auto split mode） |
| `—c`          | 只检查语法，不执行程序                                       |
| `-C dir`      | 在执行前改变目录（等价于 `-X`）                              |
| `-d`          | 启动调试模式（等价于 `-debug`）                              |
| `-F pat`      | 指定 pat 作为默认的分离模式（`$;`）                          |
| `-e prog`     | 指定 prog 作为程序在命令行中执行，可以指定多个 `-e`选项，用来指向多个程序 |
| `-h`          | 显示命令行选项的一个概览                                     |
| `-i [ ext]`   | 把文件内容重写为程序输出，原始文件会被加上扩展名 ext 保存下来；如果未指定 ext，原始文件会被删除 |
| `-I dir`      | 添加 dir 作为加载库的目录                                    |
| `-K [ kcode]` | 指定多字节字符集编码，e 或 E 对应 EUC （extended Unix code），s 或 S 对应 SJIS（Shift-JIS），u 或 U 对应 UTF-8，a、A、n 或 N 对应 ASCII |
| `-I`          | 启动自动行尾处理，从输入行取消一个换行符，并向输出行追加一个换行符 |
| `-n`          | 把代码放置在一个输入循环中（就像在 while get; ... end 中一样） |
| `-0 [ octal]` | 设置默认的记录分隔符（`$/`）为八进制，如果未指定 octal 默认为 \0 |
| `-p`          | 把代码放置在一个输入循环中，在每次迭代后输出变量 `$_` 的值   |
| `-r lib`      | 使用 `require` 来加载 lib 作为执行前的库                     |
| `-s`          | 解读程序名称和文件参数之间的匹配模式 -xxx 的任何参数作为开关，并定义相应的变量 |
| `-T [ level]` | 设置安全级别，执行不纯度测试（如果未指定 level ，则默认值为 1） |
| `-v`          | 显示版本，并启用冗余模式                                     |
| `-w`          | 启用冗余模式，如果未指定程序文件，则从 `STDIN` 读取          |
| `-x [ dir]`   | 删除 `#!ruby` 行之前的文本，如果指定了 dir，则把目录改变为 dir |
| `-X [ dir]`   | 在执行前改变目录（等价于 `-C`）                              |
| `-y`          | 启用解析器调试模式                                           |
| `--copyright` | 显示版权声明                                                 |
| `--debug`     | 启用调试模式（等价于 `-d`）                                  |
| `--help`      | 显示命令行选项的一个概览（等价于 `—h`）                      |
| `--verbose`   | 启用冗余模式（等价于 `-v`），设置 `$VERBOSE=true`            |
| `--yydebug`   | 启用解析器调试模式（等价于 `-y`）                            |

### 1.3. 环境变量

​	Ruby 解释器使用下列环境变量来控制它的行为。ENV 对象包含了所有当前设置的环境变量列表。

| 变量               | 描述                                                         |
| ------------------ | ------------------------------------------------------------ |
| `DLN_LIBRARY_PATH` | 动态加载模块搜索的路径                                       |
| `HOME`             | 当没有参数传递给 `Dir::chdir` 时，要移动到的目录             |
| `LOGDIR`           | 当没有参数传递给 `Dir::chdir`且未设置环境变量 `HOME` 时，要移动到的目录 |
| `PATH`             | 执行子进程的搜索路径，以及在指定 `-S` 选项后，Ruby 程序的搜索路径 |
| `RUBYLIB`          | 库的搜索路径                                                 |
| `RUBYLIB_PREFIX`   | 用于修改 `RUBYLIB` 搜索路径，通过格式 `path1;path2` 或 `path1path2`，把库的前缀 path1 替换为 path2 |
| `RUBYOPT`          | 传给 Ruby 解释器的命令行选项，在 taint 模式时被忽略（其中 `$SAFE>0`） |
| `RUBYPATH`         | 指定 `-S`选项后，Ruby 程序的搜索路径，优先级高于 PATH，在 taint 模式时被忽略（其中 `$SAFE>0`） |
| `RUBYSHELL`        | 指定执行命令时所使用的 shell，如果未设置该环境变量，则使用 shell 或 comspec |

### 1.4. 语法

​	所有的 Ruby 文件的扩展名都是 `.rb`，指定可用的 Ruby 解释器后，可以尝试运行程序。

#### 1.4.1. 程序中的空白

​	在 Ruby 代码中的空白字符，如空格和制表符一般会被忽略，除非当它们出现在字符串中时才不会被忽略，然而，有时候它们用于解释模棱两可的语句。当启用 `-w` 选项时，这种解释会产生警告。

```ruby
# 解释为两数相加
a + b
# 将 +b 解释为参数，a 解释为函数名
a +b
```

#### 1.4.2. 程序中的行尾

​	Ruby 把分号和换行符解释为语句的结尾。但是，如果 Ruby 在行尾遇到运算符，如：`+`、`-` 或 `\` 它们表示一个语句的延续。

#### 1.4.3. 标识符

​	标识符是变量、常量和方法的名称。Ruby 标识符是大小写敏感的，可以包含字母、数字和下划线字符。

#### 1.4.4. 保留字

​	Ruby 中的保留字不能作为常量或变量的名称，但是，它们可以作为方法名。

<table>
  <tr>
  	<td>BEGIN</td>
    <td>do</td>
    <td>next</td>
    <td>then</td>
  </tr>
  <tr>
  	<td>END</td>
    <td>else</td>
    <td>nil</td>
    <td>true</td>
  </tr>
  <tr>
  	<td>alias</td>
    <td>elseif</td>
    <td>not</td>
    <td>undef</td>
  </tr>
  <tr>
  	<td>and</td>
    <td>end</td>
    <td>or</td>
    <td>unless</td>
  </tr>
  <tr>
  	<td>begin</td>
    <td>ensure</td>
    <td>redo</td>
    <td>until</td>
  </tr>
  <tr>
  	<td>break</td>
    <td>false</td>
    <td>rescue</td>
    <td>when</td>
  </tr>
  <tr>
  	<td>case</td>
    <td>for</td>
    <td>retry</td>
    <td>while</td>
  </tr>
  <tr>
  	<td>class</td>
    <td>if</td>
    <td>return</td>
    <td>yield</td>
  </tr>
  <tr>
  	<td>def</td>
    <td>in</td>
    <td>self</td>
    <td>__FILE__</td>
  </tr>
  <tr>
  	<td>defined?</td>
    <td>module</td>
    <td>super</td>
    <td>__LINE__</td>
  </tr>
</table>

#### 1.4.5. Here Document

​	指建立多行字符串，在 `<<` 之后，可以指定一个字符串或标识符来终止字符串，且当前行之后指导终止符为止的所有行是字符串的值。

​	如果终止符用引号括起，引号的类型决定了操作字符串的类型。

**注意**：`<<` 和终止符之间必须没有空格。

#### 1.4.6. BEGIN 语句

​	声明的代码块在程序运行之前执行。

```ruby
BEGIN {
	code
}
```

#### 1.4.7. END 语句

​	声明的代码块在程序运行之后执行。

```ruby
END {
	code
}
```

#### 1.4.8. 注释

​	注释会对 Ruby 解释器隐藏一行，或者一行的一部分，或者若干行。可以在行首使用字符 `#`。

​	另一种注释的形式，通过块注释对解释器隐藏多行内容。

```ruby
=begin
...
...
...
=end
```

### 1.5. 数据类型

#### 1.5.1. 数值类型（Number）

##### 整型

​	整形分为两种，如果在 31 位以内（四字节），为 `Fixnum` 实例；如果超过，为 `Bignum`  实例。整数范围从 $-2^{30} \sim 2^{30}-1$，在这个范围内的整数是类 `Fixnum` 的对象，当整数值超过这个范围，会自动转化为 `Bignum` 类型。

​	可以在整数前使用一个可选的前导符号，0 对应八进制（Octal），0x 对应十六进制（Hex），0b 对应二进制（Binary），下划线字符在数字字符中被忽略。

##### 浮点数

​	Ruby 支持浮点数，它们是带有小数的数字。浮点数是类 `Float` 的对象，且可以是下列中任意一个。

```ruby
f1 = 0.0
f2 = 1.0e6
f3 = 4E20
f4 = 4e+20
```

##### 算术操作





























































































































































































































































































































## 2. Ruby 高级教程

