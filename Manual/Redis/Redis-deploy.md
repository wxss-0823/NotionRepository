# Redis 部署

## 1. Redis 主从服务器部署

### 1.1. 启动主服务器

​	首先需要启动主服务器，通过命令行指令 `redis.exe redis.windos.conf` 。

​	此条命令一定要在 Redis 根目录下执行，否则找不到对应配置文件；也不可忽略配置文件的声明，Redis 默认使用的配置文件并不是 `redis.windows.conf`，对该文件的修改全部无法应用到 Redis 实例中。

​	默认以端口号 6379 启动。

### 1.2. 启动从服务器

​	启动从服务器的同时指定其主服务器，通过命令 `redis-server.exe redis.windows.conf --port 6380 --slaveof 127.0.0.1 6379`。

​	此条命令可以指定从服务器运行的端口号，与其所属主服务器的 IP 和端口号。

### 1.3. 启动从服务器实例

​	实例默认以端口号 6379 启动，所以此时需要在启动的同时指定端口号，通过命令 `redis-cli.exe -h 127.0.0.1 -p 6380`。

​	此条命令可以指定从服务器实例的 IP 和端口号。

### 1.4. 修改配置文件

​	此时全部预备环境已经搭建好，这时候其实主服务器与从服务器已经建立了连接，在从服务器实例中，通过命令 `info replication` ，可以查看当前实例的信息，已经被描述为从服务器。但是实际应用中，往往需要密码验证访问。

​	在配置文件中增加：

> masterauth root	# 在从服务器中设置访问主服务器需要的密码
> requirepass root	# 在主服务器中设置被从服务器访问需要的密码

​	重新执行前三步，此时输入命令 `info replication` 会提示需要 AUTH，输入命令 `AUTH root`，即可成功连接主服务器，并返回 `info replication` 的结果。

